\documentclass[class=article, crop=false]{standalone}

\begin{document}
	
\subsection{Motion Estimation} \label{Subsection4.1}
In order to correct for motion, it must first be accurately characterised. Restricting ourselves mainly to head movements, the focus will be on rigid body motion. Motion information can be obtained by the MR scanner itself, through `navigator-based' estimation. Alternatively, external hardware can be used to find motion parameters. While navigator-based estimation has the obvious advantage of not needing additional hardware to the MR scanner, it places restrictions on the pulse sequence which may rule out its use in some situations. These considerations will be discussed in further detail below.

\subsubsection{Navigator-based Estimation}
Navigator based estimation can be further broken down into two categories: navigator echoes and self-navigators. Navigator echoes are additional pulse sequences that are inserted into the host sequence. Self-navigators on the other hand, are specially designed k-space trajectories that oversample portions of k-space in order to extract motion information.

\paragraph{Navigator echoes:}
The navigator echo (NAV) was first introduced by Ehman and Felmlee \parencite*{Ehman1989}. In this work, an additional $\pi$ pulse was inserted into a spin echo sequence, with a corresponding readout in the frequency encoding dimension. The NAV readout was not phase encoded, but could be Fourier transformed and compared with a reference NAV image to determine if bulk motion in the frequency encoding dimension had occurred. 
\par
Since the work of Ehman and Felmlee, more complex navigator echoes have been developed, in order to estimate higher DOF motion. The orbital navigator (oNav), introduced by Fu et al. \parencite*{ZhuoWuFu1995}, presented a way of estimating in plane translations and rotations. The inserted navigator echo sampled the circumference of a circle in k-space. The rotation could be estimated by comparing the magnitude of the raw oNav data with a reference view, and finding the rotation that minimised the difference. Translations could then be determined by looking at the raw phase data. The use of three orthogonal oNavs was later used to estimate motion in six DOF \parencite{Ward2000}, and a combination of two orthogonal NAV echoes with oNav has been shown to be effective in correcting for both in plane and through plane motion in 2D multi-slice imaging \parencite{Lin2014}. The use of oNavs has been limited however, due to their inability to adequately account for motion orthogonal to the navigator sampling trajectory. While this problem was acknowledged by Ward et al., their proposed solution of acquiring multiple oNav sets to iteratively correct for this motion is perhaps too expensive time-wise.
\par
Spherical navigators (sNav) were suggested as an alternative to oNavs that provided similar six DOF motion estimation, but without the same sensitivity to through plane motion effects \parencite{Welch2001,Petrie2005}. Despite being effective in this regard and rapid in acquisition, the estimation of 6 DOF motion parameters (both iteratively and non-iteratively) remains computationally intensive \parencite{Welch2004,Costa2010,Costa2005}. This has restricted the use of sNavs to retrospective motion correction. Recent efforts to reduce computation time have led to the use of template matching as opposed to registration of spheres \parencite{Liu2011,Johnson2016}. Here, extra time is needed before the scan to acquire baseline rotations templates that cover the anticipated range of rotation. While the technique in \cite{Johnson2016} was implemented for retrospective correction, the authors suggested that a total sNav processing time of 35 ms per shot could be achieved with optimisation, making it feasible for prospective motion correction.
\par
Another solution to the problem of through-plane motion is the use of a cloverleaf navigator \parencite{VanDerKouwe2006}. Before the scan, a map of features around the cloverleaf navigator is acquired, which, like the template sNav methods mentioned previously, requires a few seconds in which the patient is motionless. This map, which is a series of slightly rotated cloverleaf trajectories, can then be used to correct out-of-plane errors. The advantage that the cloverleaf navigator has over sNavs is its time requirement of 4.2 ms. It can be inserted before or after gradient encoding, without the need for an extra rf pulse. The cloverleaf trajectory samples k-space far less densely than sNavs however, so acquired motion estimates are more susceptible to noise.
\par
A common thread that is shared amongst oNavs, sNavs and cloverleaf trajectories is that they all estimate motion with the use of the raw k-space data. This has some advantages. Rotations rotate k-space magnitude and phase, while translations affect phase only, and thus motion estimation in k-space is a decoupled problem. Also, k-space does not have to be sampled fully to estimate motion, saving time in acquisition. A potentially serious downside though is the presence of non-rigid motion. Parts of the head such as the jaw or neck may move relative to the brain, adversely affecting k-space based rigid body motion estimates.
\par
A technique that is robust to the previously mentioned problem is PROMO (PROspective MOtion correction) \parencite{White2010a}. It uses image space rather than k-space to estimate motion. Three orthogonal spiral navigators are used to reconstruct three  images. A region of interest is drawn around the brain in a reference navigator image set, and voxels outside this region are ignored in tracking. The motion of the brain is then tracked in image space using an Extended Kalman Filter (EKF) approach. Non-rigid motion of regions outside the brain therefore does not affect motion estimates. Acquisition of the spiral navigators and their reconstruction requires about 48 ms of time within the pulse sequence.
\par
A natural extension to the idea of acquiring three orthogonal images is acquiring entire volumes, and using image registration for motion estimation. Volumetric EPI navigators (vNavs) were first used in single voxel spectroscopy \parencite{Hess2011}, and later for neuroanatomical imaging \parencite{Tisdall2012}, as well as also diffusion tensor imaging \parencite{MRM:MRM23314}. The scan times of the navigators, inserted once per TR, were 275 ms for \cite{Tisdall2012} and 406 ms for \cite{MRM:MRM23314}. The significant time overhead required for the acquisition of vNAVs therefore rules them out for insertion into host sequences such as FLASH and EPI, unless the navigators are interleaved between TRs.
\par 
In addition to k-space navigators and image-space navigators, there has also been interest in non-encoded free induction decay (FID) navigators \parencite{Waszak2016,MRM:MRM22797}. FID navigators are ultrashort ($<$100 $\mu$s) pulses that are not gradient encoded, meaning they can fit quite comfortably into most sequences. Because they are not encoded, the signals themselves contain no spatial information, and so are not currently used to measure motion, but rather to simply detect it. Motion causes changes in the FID signal received by each RF coil. This can then be compared to a `motion-free' reference to detect motion, in which case a separate navigator (like the ones discussed previously) is inserted into the sequence. The use of FID navigators can thus offer increased flexibility by facilitating selective use of navigator echoes. 

\paragraph{Self-navigation:}
Some imaging sequences are said to be `self-navigating'. These sequences can be likened to a `bootstrap' process, in which the existing, collected data is used to estimate motion, rather than relying on inserted navigator echoes. This is achieved by oversampling some area of k-space. The most ubiquitous of these is PROPELLER (Periodically Rotated Overlapping Parallel Lines with Enhanced Reconstruction), developed by Pipe \parencite*{Pipe1999}. The method has found widespread clinical use, and is offered by most vendors (under different trade names) as a `motion robust' sequence.
\par
In PROPELLER, k-space is sampled in rectangular strips that are rotated about the centre, visually resembling the rotating blade of a propeller. Each strip comprises of lines acquired using a Cartesian sequence (such as FSE or EPI), but due to the fact that each strip is rotated relative to the other, PROPELLER shares many characteristics with radial sequences. After all acquisition cycles, a central disc in k-space has been sampled by each strip. Using this redundant data, first rotations, then translations can be estimated and corrected for.
\par
The obvious advantage PROPELLER has over navigator echoes is efficiency, as the collected data is used to correct itself. However, this motion information from oversampling comes at the cost of increased scan time, in this case by a factor of $\pi/2$ \parencite{Pipe1999}. Methods have been proposed to reduce this factor, such as under-sampling \parencite{Arfanakis2005,Tamhane2012}, and the utilisation of parallel imaging \parencite{Li2011,Skare2008,Chuang2006}. The trade-off for the former is SNR, while the latter can be more sensitive to motion, or less accurate in its quantification \parencite{Tamhane2012}.
\par
SNAILS (Self-Navigated Interleaved Spirals) is an attractive alternative to PROPELLER in DWI \parencite{Liu2004,Liu2005}. It samples k-space with interleaved, variable density spiral trajectories. The sampling density decreases as distance from the k-space centre increases, and the oversampled centre of k-space is used to estimate in-plane rotations and translations in a similar way to PROPELLER.
\par 
Other self-navigation techniques have been proposed, but have not yet found the popularity of PROPELLER, often due to being more limited in their applicability. Examples include specially ordered radial trajectories \parencite{Welch2004a,Kim2008,Anderson2011}, which are quite sensitive to hardware considerations such as coil sensitivities and eddy currents, and TRELLIS (Translation and Rotation Estimation using Linear Least-squares Interleaved Strips) \parencite{Maclaren2008}, which is more efficient than PROPELLER in that it oversamples k-space less, though likely with a penalty to motion quantification accuracy. MOJITO (Multiple Overlapping k-space Junctions for Investigating Translating Objects) \parencite{Bookwalter2010} is an algorithm that has been used in conjunction with bow-tie trajectories to estimate in plane translations. The authors also suggested its potential use alongside PROPELLER, though this has yet to be shown.
\par 
Although self-navigating trajectories, especially PROPELLER, have been successful, they are mainly limited to 2D imaging. Through plane motion is ignored, and thus full quantification of 6 DOF motion for 3D correction is not possible. In the case of PROPELLER, a correlation weighting is used to reject data, which could compensate for very slight through plane motion.

\subsubsection{External Hardware-based Estimation}
Motion estimation can also be done with specialised hardware. The use of devices other than the scanner to measure motion means that the imaging sequence does not have to be modified in order to accommodate navigator echoes or a self-navigating trajectory. Movement can thus be tracked under more general circumstances. With the use of external hardware however, comes the need for accurate cross-calibration between the tracking device and scanner. The ability of tracking devices to perform accurately in the presence of strong magnetic fields is also of concern.
\paragraph{Camera tracking:}
Perhaps the most obvious way of tracking motion with external hardware is the use of one or more cameras in combination with markers attached to the patient. Indeed, this is a successful approach seen in other medical imaging modalities that image the head such as CT \parencite{Kim2015,Kim2016} and PET \parencite{Bloomfield2003,Fulton2002}.
\par 
Early work in adapting motion tracking hardware for use with MRI includes work done by \cite{Tremblay2005a}, \cite{Zaitsev2006a} and \cite{Dold2006}. In all of these studies, an infrared stereo camera setup was used in conjunction with retroreflective markers attached via mounting tools attached to the head \parencite{Tremblay2005a}, or a mouthpiece \parencite{Zaitsev2006a,Dold2006}. For MR compatibility, the cameras were placed out of bore. The attachment of markers with the apparatus used in these studies is likely too unwieldy for routine clinical use, and the placement of cameras outside the bore is not ideal for tracking accuracy or line of sight considerations. Nevertheless, the studies were an important proof of concept, showing that accurate tracking of head motion using external hardware in MRI could be achieved.
\par
Moving the cameras inside the bore was shown to be feasible by \cite{Qin2009}, which allowed the tracking of a smaller marker attached to the forehead. Since then, numerous studies have been published validating the use of a monocular, rather than stereo, in-bore camera setup \parencite{Aksoy2011,Aksoy2017,Forman2011,Maclaren2012,Andrews-Shigaki2011,MacLaren2011,Gumus2015a}. The use of just one camera is facilitated by attaching markers with some known geometric configuration \parencite{Forman2011}, or `retro-grate reflector' markers that encode depth information in moiré phase patterns \parencite{Andrews-Shigaki2011}.
\par
The main strengths of camera tracking are its aforementioned generality of use, and the potential for higher frequency of motion estimates than navigator echo methods. High accuracy and sensitivity to motion is also possible, with Maclaren et al. \parencite*{Maclaren2012} reporting accuracy of \~{}0.1 mm for translations and better than $0.07^{\circ}$ for rotations with the use of a moiré phase marker and single camera.
\par
The motion estimates reported by these camera systems is only valid for a self-defined coordinate system. In order for these quantitative estimates to be used in motion correction, they must be transformed to scanner coordinates. The process of acquiring this transform is known in MRI literature as cross-calibration. According to an analysis by Zahneisen, Keating and Ernst \parencite*{Zahneisen2014a}, errors in cross-calibration should be substantially below 1 mm and $1^{\circ}$ for typical clinical applications. 
\par 
Cross-calibration procedures can vary dependent on available tools, but commonly involve acquiring MR images of a phantom with an attached marker, or markers that are visible both to the camera and scanner. The transformation that best describes the data is then found \parencite{Zahneisen2014,Aksoy2011,Zaitsev2006a}. Further adjustments to correct for errors in calibration can be made iteratively by applying motion correction, and measuring the residual motion \parencite{Zaitsev2006a,Zahneisen2014}. Alternatively, \cite{Aksoy2012} corrected for errors in cross-calibration retrospectively, after prospective motion correction had already been applied.
\par
Another consideration for the use of tracking cameras and attached markers is marker fixation. Relative motion between the patient and markers due to slippage or detachment will results in errors in motion estimation. With current methodologies, there is a tradeoff between patient comfort and a high degree of marker fixation \parencite{Maclaren2013}. Certain movements may also lead to partial or full marker occlusion, dependent on the camera geometry and marker design. As a potential fix to this, Singh et al. \parencite*{Singh2015} explored using an addition marker as a redundancy, which could also potentially be used to detect nonrigid motion events. However, attaching additional markers (or any markers at all), is not ideal from a clinical workflow perspective. A markerless motion tracking method for MRI would thus be highly desirable.

\paragraph{Active markers:} Methods for tracking fiducial markers using optical cameras was outlined above. A similar approach involves the tracking of markers that are visible to the MR scanner - small samples of doped water and a receive coil with very localised sensitivity, whose location can be ascertained using short navigator pulses. The position of these receive coils can be ascertained with the application of three RF pulses and associated gradients.
\par 
Derbyshire et al. \parencite*{Derbyshire1998} used three active markers to calculated rigid body motion of the head and correct for motion slice-by-slice. Real-time correction was then shown to be feasible by Ooi et al. \parencite*{Ooi2009} and Krueger et al. \parencite*{Krueger2006}. In each of these examples, the active markers were wired to an independent receiver channel.

\subsection{Retrospective Motion Correction}
Retrospective motion correction aims to undo the misregistration of k-space data due to motion. As alluded to earlier, this involves re-assigning the acquired signal to it's correct position in k-space by applying the appropriate transform (Figure). Correcting for translations is relatively straightforward given the motion is known, as it involves a simple phase correction to each k-space point \parencite{Ehman1989}. For rotations, the data itself has to be rotated. Rotating portions of the acquired data means that k-space has not been uniformly sampled, leaving some regions undersampled. This can be problematic, as undersampling can mean localised violations of the Nyquist criterion, which manifests as ghosting in the reconstructed image.  
\par
Methods to mitigate this undersampling effect include using parallel imaging to regenerate k-space data \parencite{Bydder2003,Larkman2004,Bammer2007}. In principle, the local undersampling caused by rotating k-space data is no different to acquisition trajectories that undersample k-space. The redundancy in datasets from multiple receiver coils can be exploited, if coil sensitivity information is available. There is an inherent tradeoff here, as increasing the parallel imaging acceleration factor diminishes the ability to accurately correct for rotational motion. A compromise has to be made between speeding up the imaging process (which could reduce motion artifacts in and of itself), and not undersampling k-space so much that rotational motion cannot be effectively corrected for.
\par
Another consideration when rotating k-space data is regridding. In order to exploit the FFT, the sampled data must lie on a Cartesian grid. Various interpolation methods exist to regrid the data, which are usually integrated into retrospective motion correction algorithms in the form of a regridding matrix, similarly to the treatment of non-Cartesian sampling trajectories \parencite{Atkinson2003,Jackson1991,Batchelor2005,Bammer2007}.
\par
While motion information is often derived from methods described in the previous section, motion estimation can also be integrated into the post-processing step. This is termed `autofocusing', and does not require prior motion estimates, though they can be provided for improved processing speed. Motion is estimated by applying transformations to the data iteratively and optimizing a metric such as image entropy \parencite{Atkinson1997,Atkinson1999,McGee2000} or gradient entropy \parencite{Loktyushin2013}. These methods are very computationally intensive, especially without prior motion estimates from navigators or tracking data.
\par

\subsection{Prospective Motion Correction}
As its name suggests, prospective motion correction (PMC) aims to compensate for subject motion during the scan. This is achieved by real-time updates of gradient and RF fields in response to detected motion, in order to keep the spatial relationship between the subject and FOV constant. Mathematically, it can be described by pre-multiplying the motion affected, augmented k-space vector $\tilde{\textbf{k}}$ (see Section \ref{Section212}) by $\textbf{A}^{-T}$, where \textbf{A} is the measured motion. 
\par
The first published example of this approach for head motion was a study by Lee et al. \parencite*{Lee1996}. Motion between slice acquisitions in fMRI was prospectively compensated for by adjusting the slice location, with inserted NAV echoes providing motion information along the axial direction. This method was later built upon to correct for both through-plane and in-plane rotational motion with the use of oNavs \parencite{Lee1998}. Full six DOF PMC was then shown to be successful with motion estimates obtained from oNavs \parencite{Ward2000} and sNavs \parencite{Welch2001}, active markers \parencite{Derbyshire1998}, image registration \parencite{Thesen2000} and optical cameras \parencite{Zaitsev2006a}.
\par
Within the last decade, interest in PMC has remained strong. Advancements have mainly come in the form of integrating more accurate and convenient methodologies for motion estimation (see \ref{Subsection4.1}). There are a few reasons why PMC is attractive:

\begin{itemize}
	\item It is a general approach that can be applied to not only most imaging sequences (when external tracking is used), but spectroscopy as well. 
	\item Sampling density remains uniform. One of the challenges for retrospective motion correction was dealing with the gaps in k-space that resulted from rotational motion. Prospective motion correction avoids this issue as the imaging FOV is kept constant throughout the scan. 
	\item The ability to account for certain effects that cannot be corrected retrospectively, namely spin history effects \parencite{Yancey2011} and signal dropouts in DWI \parencite{Herbst2012}.
	\item Images available without delay. Retrospective methods can be computationally intensive, and can introduce an unwanted delay in reconstructing a usable image after data acquisition.
\end{itemize}
\par
Despite these advantages and being an active area of research, several challenges must be addressed before PMC can be implemented for routine clinical use. Perhaps the greatest risk posed by the method is its potential to corrupt otherwise useful data. Once a given scan is committed to having PMC being performed on it, jittery or erroneous motion estimates can induce gradient or RF field changes that introduce artifacts, even when no motion is present. In the case of jittery motion estimates or erroneous calibration, combining PMC with retrospective methods is possible \parencite{MacLaren2011,Aksoy2012}. Using PMC and RMC in combination has promising potential to patch up some of the downsides present in both approaches, coming at the cost of increased algorithmic complexity and the `instant imaging' upside offered by PMC.
\par
In a similar vein to the problem above, it can be difficult to demonstrate the benefit of PMC, given the lack of an `uncorrected' dataset when the method is applied. One potential solution this problem which is perhaps only applicable to a research setting is to carry out two scans on the same subject - one with motion and PMC applied, and the other with no motion but with the same gradient and RF updates as the previous scan \parencite{Herbst2012}. Artifacts introduced by applying PMC to a stationary subject in the second scan would therefore simulate the expected motion artifacts in the first scan had PMC not been applied. Another interesting approach to the same problem taken by Zahneisen et al. \parencite*{Zahneisen2016a} was to apply retrospective motion correction to `de-correct' the corrections applied by PMC, which provided an extra dataset for comparison.
\par


\end{document}